# Cash Server API

## Запуск

```bash
docker compose up --build
```

## Базовый URL

## Аутентификация

Все запросы к конечным точкам документов требуют действительного JWT токена. Получите токен, аутентифицировавшись через конечную точку `/auth`.

## Эндпоинты

### Аутентификация пользователей

#### 1. Регистрация нового пользователя

- **URL:** `/api/register`
- **Метод:** `POST`
- **Тело запроса:**
  ```json
  {
    "login": "ваш_логин",
    "password": "ваш_пароль"
  }
  ```
- **Ответ:**
  - **201 Created**
  ```json
  {
    "message": "Пользователь успешно зарегистрирован"
  }
  ```

#### 2. Аутентификация пользователя

- **URL:** `/api/auth`
- **Метод:** `POST`
- **Тело запроса:**
  ```json
  {
    "login": "ваш_логин",
    "password": "ваш_пароль"
  }
  ```
- **Ответ:**
  - **200 OK**
  ```json
  {
    "token": "ваш_jwt_токен"
  }
  ```
  - **401 Unauthorized**
  ```json
  {
    "error": "неверный логин или пароль"
  }
  ```

#### 3. Выход пользователя

- **URL:** `/auth/:token`
- **Метод:** `DELETE`
- **Ответ:**
  - **204 No Content**

### Управление документами

#### 1. Загрузка документа

- **URL:** `/api/docs`
- **Метод:** `POST`
- **Заголовки:**
  - **Authorization:** `Bearer ваш_jwt_токен`
- **Тело запроса:**
  - **Form-data:**
    - `file` (тип: Файл)
    - `name`: "photo.jpg"
    - `mime`: "image/jpeg"
    - `is_public`: false
- **Ответ:**
  - **201 Created**
  ```json
  {
    "id": "идентификатор_документа",
    "file_path": "uploads/photo.jpg"
  }
  ```

#### 2. Получение списка документов

- **URL:** `/api/docs`
- **Метод:** `GET`
- **Заголовки:**
  - **Authorization:** `Bearer ваш_jwt_токен`
- **Параметры запроса:**
  - `login` (опционально): Фильтрация по логину пользователя
  - `key` (опционально): Имя колонки для фильтрации
  - `value` (опционально): Значение для фильтра
  - `limit` (опционально): Количество документов для получения
- **Ответ:**
  - **200 OK**
  ```json
  {
    "data": {
      "docs": [
        {
          "id": "идентификатор_документа",
          "name": "photo.jpg",
          "mime": "image/jpeg",
          "file": true,
          "public": false,
          "created": "2024-10-13 20:25:16"
        }
      ]
    }
  }
  ```

#### 3. Получение документа по ID

- **URL:** `/docs/:id`
- **Метод:** `GET`
- **Заголовки:**
  - **Authorization:** `Bearer ваш_jwt_токен`
- **Ответ:**
  - **200 OK**
  ```json
  {
    "id": "идентификатор_документа",
    "name": "photo.jpg",
    "mime": "image/jpeg",
    "file_path": "uploads/photo.jpg",
    "is_public": false,
    "created_at": "2024-10-13T20:25:16Z"
  }
  ```

#### 4. Удаление документа

- **URL:** `/docs/:id`
- **Метод:** `DELETE`
- **Заголовки:**
  - **Authorization:** `Bearer ваш_jwt_токен`
- **Ответ:**
  - **204 No Content**

## Обработка ошибок

В случае ошибки API вернет JSON-объект с сообщением об ошибке. Например:

```json
{
  "error": "Токен не предоставлен"
}
```
